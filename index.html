<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker Coach</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ICON WRAPPER FOR SINGLE HTML ---
        const Icon = ({ name, size = 24, className = "" }) => {
            useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} style={{width: size, height: size}} className={className}></i>;
        };

        // --- CONFIGURATION ---
        const SUITS = [
            { name: 'Spades', symbol: '♠', color: 'text-gray-900', id: 's' },
            { name: 'Hearts', symbol: '♥', color: 'text-red-600', id: 'h' },
            { name: 'Diamonds', symbol: '♦', color: 'text-red-600', id: 'd' },
            { name: 'Clubs', symbol: '♣', color: 'text-gray-900', id: 'c' },
        ];

        const VALUES = [
            { label: '2', rank: 2 }, { label: '3', rank: 3 }, { label: '4', rank: 4 },
            { label: '5', rank: 5 }, { label: '6', rank: 6 }, { label: '7', rank: 7 },
            { label: '8', rank: 8 }, { label: '9', rank: 9 }, { label: '10', rank: 10 },
            { label: 'J', rank: 11 }, { label: 'Q', rank: 12 }, { label: 'K', rank: 13 }, { label: 'A', rank: 14 },
        ];

        const RANK_KEYS = ["High Card", "One Pair", "Two Pair", "Three of a Kind", "Straight", "Flush", "Full House", "Four of a Kind", "Straight Flush", "Royal Flush"];

        const EXAMPLE_HANDS = {
            "Royal Flush": [{ label: '10', symbol: '♠', color: 'text-gray-900', dim: false }, { label: 'J', symbol: '♠', color: 'text-gray-900', dim: false }, { label: 'Q', symbol: '♠', color: 'text-gray-900', dim: false }, { label: 'K', symbol: '♠', color: 'text-gray-900', dim: false }, { label: 'A', symbol: '♠', color: 'text-gray-900', dim: false }],
            "Straight Flush": [{ label: '5', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '6', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '7', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '8', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '9', symbol: '♣', color: 'text-gray-900', dim: false }],
            "Four of a Kind": [{ label: 'A', symbol: '♦', color: 'text-red-600', dim: false }, { label: 'A', symbol: '♣', color: 'text-gray-900', dim: false }, { label: 'A', symbol: '♥', color: 'text-red-600', dim: false }, { label: 'A', symbol: '♠', color: 'text-gray-900', dim: false }, { label: '8', symbol: '♣', color: 'text-gray-900', dim: true }],
            "Full House": [{ label: 'K', symbol: '♠', color: 'text-gray-900', dim: false }, { label: 'K', symbol: '♥', color: 'text-red-600', dim: false }, { label: 'K', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '10', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '10', symbol: '♠', color: 'text-gray-900', dim: false }],
            "Flush": [{ label: 'Q', symbol: '♦', color: 'text-red-600', dim: false }, { label: '8', symbol: '♦', color: 'text-red-600', dim: false }, { label: '6', symbol: '♦', color: 'text-red-600', dim: false }, { label: '4', symbol: '♦', color: 'text-red-600', dim: false }, { label: '3', symbol: '♦', color: 'text-red-600', dim: false }],
            "Straight": [{ label: '2', symbol: '♦', color: 'text-red-600', dim: false }, { label: '3', symbol: '♠', color: 'text-gray-900', dim: false }, { label: '4', symbol: '♠', color: 'text-gray-900', dim: false }, { label: '5', symbol: '♦', color: 'text-red-600', dim: false }, { label: '6', symbol: '♣', color: 'text-gray-900', dim: false }],
            "Three of a Kind": [{ label: 'J', symbol: '♥', color: 'text-red-600', dim: false }, { label: 'J', symbol: '♣', color: 'text-gray-900', dim: false }, { label: 'J', symbol: '♠', color: 'text-gray-900', dim: false }, { label: '5', symbol: '♣', color: 'text-gray-900', dim: true }, { label: '8', symbol: '♦', color: 'text-red-600', dim: true }],
            "Two Pair": [{ label: '6', symbol: '♠', color: 'text-gray-900', dim: false }, { label: '6', symbol: '♥', color: 'text-red-600', dim: false }, { label: '10', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '10', symbol: '♦', color: 'text-red-600', dim: false }, { label: 'K', symbol: '♦', color: 'text-red-600', dim: true }],
            "One Pair": [{ label: 'A', symbol: '♥', color: 'text-red-600', dim: false }, { label: 'A', symbol: '♣', color: 'text-gray-900', dim: false }, { label: '2', symbol: '♦', color: 'text-red-600', dim: true }, { label: '6', symbol: '♥', color: 'text-red-600', dim: true }, { label: '8', symbol: '♠', color: 'text-gray-900', dim: true }],
            "High Card": [{ label: 'K', symbol: '♥', color: 'text-red-600', dim: false }, { label: 'J', symbol: '♦', color: 'text-red-600', dim: true }, { label: '10', symbol: '♣', color: 'text-gray-900', dim: true }, { label: '6', symbol: '♥', color: 'text-red-600', dim: true }, { label: '3', symbol: '♦', color: 'text-red-600', dim: true }]
        };

        const TRANSLATIONS = {
            en: {
                title: "Poker Coach", subtitle: "Master the ranks, one hand at a time.", table: "The Table (Community)", hand: "Your Hand (Hole Cards)", select: "Select the Highest Hand", next: "Next Hand", cheatSheetBtn: "Rankings", cheatSheetTitle: "Poker Hand Rankings", score: "Score", accuracy: "Accuracy", correctTitle: "Excellent!", wrongTitle: "Not Quite", correctMsg: "You identified the", wrongMsg: "The best hand was", hint: "Analyze all 7 cards. The best 5-card combination wins.", helpText: "Best 5-card hand wins • Suit order does not matter.",
                ranks: { "High Card": "High Card", "One Pair": "One Pair", "Two Pair": "Two Pair", "Three of a Kind": "Three of a Kind", "Straight": "Straight", "Flush": "Flush", "Full House": "Full House", "Four of a Kind": "Four of a Kind", "Straight Flush": "Straight Flush", "Royal Flush": "Royal Flush" },
                descriptions: { "High Card": "Highest card plays.", "One Pair": "Two cards of same rank.", "Two Pair": "Two different pairs.", "Three of a Kind": "Three cards of same rank.", "Straight": "Five cards in sequence.", "Flush": "Five cards of same suit.", "Full House": "Three of a kind + pair.", "Four of a Kind": "Four cards of same rank.", "Straight Flush": "Five in sequence & suit.", "Royal Flush": "A, K, Q, J, 10 same suit." }
            },
            hu: {
                title: "Póker Edző", subtitle: "Gyakorold a kezeket leosztásról leosztásra.", table: "Az Asztal (Közös Lapok)", hand: "A Te Lapjaid", select: "Válaszd ki a legerősebb kezet", next: "Következő Leosztás", cheatSheetBtn: "Puska", cheatSheetTitle: "Kézerősségek", score: "Pontszám", accuracy: "Pontosság", correctTitle: "Kiváló!", wrongTitle: "Nem talált", correctMsg: "Helyesen felismerted:", wrongMsg: "A legjobb kéz ez volt:", hint: "Vizsgáld meg mind a 7 lapot. A legjobb 5 lapos kombináció dönt.", helpText: "A legjobb 5 lap nyer • A színek sorrendje nem számít.",
                ranks: { "High Card": "Magas Lap", "One Pair": "Egy Pár", "Two Pair": "Két Pár", "Three of a Kind": "Drill", "Straight": "Sor", "Flush": "Szín (Flush)", "Full House": "Full House", "Four of a Kind": "Póker", "Straight Flush": "Színsor", "Royal Flush": "Royal Flush" },
                descriptions: { "High Card": "A legmagasabb lap dönt.", "One Pair": "Két azonos rangú lap.", "Two Pair": "Két különböző pár.", "Three of a Kind": "Három azonos rangú lap.", "Straight": "Öt lap sorrendben.", "Flush": "Öt azonos színű lap.", "Full House": "Három egyforma és egy pár.", "Four of a Kind": "Négy azonos rangú lap.", "Straight Flush": "Öt lap sorrendben és színben.", "Royal Flush": "A, K, Q, J, 10 azonos színben." }
            }
        };

        // --- COMPONENTS ---
        const Card = ({ card, hidden = false, size = "large", dim = false }) => {
            let sizeClasses = "w-14 h-20 md:w-20 md:h-28 text-lg md:text-xl rounded-lg md:rounded-xl border-2 shadow-md";
            if (size === "small") sizeClasses = "w-8 h-12 text-xs rounded border";
            if (size === "tiny") sizeClasses = "w-6 h-9 text-[0.5rem] rounded border-[0.5px] shadow-sm";

            return (
                <div className={`relative flex flex-col items-center justify-center bg-white ${hidden ? 'bg-indigo-900 border-indigo-950' : 'border-gray-300'} ${dim ? 'opacity-40 bg-gray-100 grayscale-[0.8]' : ''} ${sizeClasses}`}>
                    {!hidden ? (
                        <>
                            <span className={`font-bold leading-none ${card.color}`}>{card.label}</span>
                            <span className={`leading-none ${size === "tiny" ? "text-xs" : (size === "small" ? "text-sm" : "text-2xl")} ${card.color}`}>{card.symbol}</span>
                        </>
                    ) : null}
                </div>
            );
        };

        const CheatSheet = ({ isOpen, onClose, lang }) => {
            if (!isOpen) return null;
            const ranksReversed = [...RANK_KEYS].reverse();
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/60 backdrop-blur-sm" onClick={onClose}>
                    <div className="bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl flex flex-col" onClick={e => e.stopPropagation()}>
                        <div className="p-4 border-b flex justify-between items-center bg-gray-50 sticky top-0 z-10">
                            <h2 className="text-xl font-bold flex items-center gap-2"><Icon name="help-circle" className="text-indigo-600" /> {TRANSLATIONS[lang].cheatSheetTitle}</h2>
                            <button onClick={onClose} className="p-2 hover:bg-gray-200 rounded-full"><Icon name="x" size={20} /></button>
                        </div>
                        <div className="p-4 space-y-2">
                            {ranksReversed.map((rankKey, index) => (
                                <div key={rankKey} className="flex flex-col sm:flex-row sm:items-center gap-4 p-3 rounded-lg border hover:bg-indigo-50 transition-colors">
                                    <div className="flex items-center gap-3 min-w-[180px]">
                                        <div className="w-8 h-8 rounded-full bg-indigo-100 text-indigo-700 font-bold flex items-center justify-center text-sm">{10 - index}</div>
                                        <div><h3 className="font-bold text-sm">{TRANSLATIONS[lang].ranks[rankKey]}</h3><p className="text-[10px] text-gray-500">{TRANSLATIONS[lang].descriptions[rankKey]}</p></div>
                                    </div>
                                    <div className="flex gap-1">
                                        {EXAMPLE_HANDS[rankKey].map((card, idx) => <Card key={idx} card={card} size="tiny" dim={card.dim} />)}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [communityCards, setCommunityCards] = useState([]);
            const [holeCards, setHoleCards] = useState([]);
            const [selectedRank, setSelectedRank] = useState(null);
            const [feedback, setFeedback] = useState(null);
            const [score, setScore] = useState({ correct: 0, total: 0 });
            const [correctRankKey, setCorrectRankKey] = useState("");
            const [lang, setLang] = useState('en');
            const [showCheatSheet, setShowCheatSheet] = useState(false);

            const t = TRANSLATIONS[lang];

            const evaluateBestHand = (sevenCards) => {
                const counts = {};
                const suitCounts = {};
                const ranks = sevenCards.map(c => c.rank).sort((a, b) => b - a);
                sevenCards.forEach(c => {
                    counts[c.rank] = (counts[c.rank] || 0) + 1;
                    suitCounts[c.name] = (suitCounts[c.name] || 0) + 1;
                });
                const countValues = Object.values(counts);
                const hasFlush = Object.values(suitCounts).some(count => count >= 5);
                const uniqueRanks = [...new Set(ranks)].sort((a, b) => b - a);
                let hasStraight = false;
                for (let i = 0; i <= uniqueRanks.length - 5; i++) { if (uniqueRanks[i] - uniqueRanks[i+4] === 4) hasStraight = true; }
                if (uniqueRanks.includes(14) && uniqueRanks.includes(2) && uniqueRanks.includes(3) && uniqueRanks.includes(4) && uniqueRanks.includes(5)) hasStraight = true;

                if (hasFlush) {
                    const flushSuit = Object.keys(suitCounts).find(s => suitCounts[s] >= 5);
                    const flushCards = sevenCards.filter(c => c.name === flushSuit).map(c => c.rank).sort((a, b) => b - a);
                    let isSF = false;
                    for (let i = 0; i <= flushCards.length - 5; i++) { if (flushCards[i] - flushCards[i+4] === 4) isSF = true; }
                    if (flushCards.includes(14) && flushCards.includes(2) && flushCards.includes(3) && flushCards.includes(4) && flushCards.includes(5)) isSF = true;
                    if (isSF) {
                        if (flushCards.includes(14) && flushCards.includes(13) && flushCards.includes(12) && flushCards.includes(11) && flushCards.includes(10)) return "Royal Flush";
                        return "Straight Flush";
                    }
                }
                if (countValues.includes(4)) return "Four of a Kind";
                const pairCount = countValues.filter(v => v === 2).length;
                const tripleCount = countValues.filter(v => v === 3).length;
                if ((tripleCount >= 2) || (tripleCount === 1 && pairCount >= 1)) return "Full House";
                if (hasFlush) return "Flush";
                if (hasStraight) return "Straight";
                if (tripleCount === 1) return "Three of a Kind";
                if (pairCount >= 2) return "Two Pair";
                if (pairCount === 1) return "One Pair";
                return "High Card";
            };

            const generateNewHand = () => {
                const newDeck = [];
                SUITS.forEach(suit => VALUES.forEach(val => newDeck.push({ ...val, ...suit })));
                for (let i = newDeck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newDeck[i], newDeck[j]] = [newDeck[j], newDeck[i]];
                }
                const comm = newDeck.slice(0, 5);
                const hole = newDeck.slice(5, 7);
                setCommunityCards(comm);
                setHoleCards(hole);
                setSelectedRank(null);
                setFeedback(null);
                setCorrectRankKey(evaluateBestHand([...comm, ...hole]));
            };

            useEffect(() => { generateNewHand(); }, []);

            const handleGuess = (rankKey) => {
                if (feedback) return;
                setSelectedRank(rankKey);
                const isCorrect = rankKey === correctRankKey;
                setFeedback(isCorrect ? 'correct' : 'wrong');
                setScore(p => ({ correct: p.correct + (isCorrect ? 1 : 0), total: p.total + 1 }));
            };

            return (
                <div className="min-h-screen bg-slate-50 p-4">
                    <CheatSheet isOpen={showCheatSheet} onClose={() => setShowCheatSheet(false)} lang={lang} />
                    <div className="max-w-4xl mx-auto">
                        <div className="flex justify-between items-center mb-6">
                            <div><h1 className="text-2xl font-extrabold flex items-center gap-2"><Icon name="trophy" className="text-amber-500" /> {t.title}</h1></div>
                            <div className="flex gap-2">
                                <button onClick={() => setLang(l => l === 'en' ? 'hu' : 'en')} className="p-2 bg-white border rounded-xl"><Icon name="globe" size={18} /></button>
                                <button onClick={() => setShowCheatSheet(true)} className="px-4 py-2 bg-white border rounded-xl font-bold text-sm">{t.cheatSheetBtn}</button>
                            </div>
                        </div>

                        <div className="grid grid-cols-2 gap-4 mb-6 text-center">
                            <div className="bg-white p-3 rounded-2xl border shadow-sm"><div className="text-xs font-bold text-slate-400 uppercase">{t.score}</div><div className="text-xl font-black text-indigo-600">{score.correct} / {score.total}</div></div>
                            <div className="bg-white p-3 rounded-2xl border shadow-sm"><div className="text-xs font-bold text-slate-400 uppercase">{t.accuracy}</div><div className="text-xl font-black text-emerald-600">{score.total === 0 ? '0' : Math.round((score.correct / score.total) * 100)}%</div></div>
                        </div>

                        <div className="bg-emerald-900 rounded-3xl p-6 md:p-10 shadow-2xl mb-8 border-8 border-emerald-950 text-center">
                            <div className="mb-8">
                                <h3 className="text-emerald-200/50 text-[10px] font-bold uppercase tracking-widest mb-4">{t.table}</h3>
                                <div className="flex flex-wrap justify-center gap-2 md:gap-4">
                                    {communityCards.map((c, i) => <Card key={i} card={c} />)}
                                </div>
                            </div>
                            <div>
                                <h3 className="text-emerald-200/50 text-[10px] font-bold uppercase tracking-widest mb-4">{t.hand}</h3>
                                <div className="flex justify-center gap-3">
                                    {holeCards.map((c, i) => <Card key={i} card={c} />)}
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div className="lg:col-span-2 bg-white rounded-3xl p-5 border shadow-sm">
                                <h3 className="font-bold mb-4 flex items-center gap-2"><Icon name="chevron-right" className="text-indigo-500" /> {t.select}</h3>
                                <div className="grid grid-cols-2 sm:grid-cols-3 gap-2">
                                    {RANK_KEYS.map((rk) => (
                                        <button key={rk} onClick={() => handleGuess(rk)} disabled={feedback !== null} className={`p-3 rounded-xl text-xs font-bold border transition-all ${selectedRank === rk ? (feedback === 'correct' ? 'bg-emerald-100 border-emerald-500 text-emerald-800' : 'bg-rose-100 border-rose-500 text-rose-800') : (feedback && rk === correctRankKey ? 'bg-emerald-100 border-emerald-500 animate-pulse' : 'bg-white hover:bg-indigo-50')} ${feedback && rk !== correctRankKey && rk !== selectedRank ? 'opacity-30' : ''}`}>
                                            {t.ranks[rk]}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="flex flex-col">
                                {feedback ? (
                                    <div className={`h-full rounded-3xl p-6 border text-center flex flex-col items-center justify-center ${feedback === 'correct' ? 'bg-emerald-50 border-emerald-200' : 'bg-rose-50 border-rose-200'}`}>
                                        <Icon name={feedback === 'correct' ? 'check-circle' : 'x-circle'} className={feedback === 'correct' ? 'text-emerald-500' : 'text-rose-500'} size={40} />
                                        <h4 className="font-bold my-2">{feedback === 'correct' ? t.correctTitle : t.wrongTitle}</h4>
                                        <p className="text-xs mb-4">{feedback === 'correct' ? t.correctMsg : t.wrongMsg} <b>{t.ranks[correctRankKey]}</b></p>
                                        <button onClick={generateNewHand} className="w-full py-3 bg-slate-900 text-white rounded-xl font-bold flex items-center justify-center gap-2">{t.next} <Icon name="refresh-cw" size={16} /></button>
                                    </div>
                                ) : (
                                    <div className="h-full bg-indigo-50 rounded-3xl p-6 border border-indigo-100 flex flex-col items-center justify-center text-center">
                                        <Icon name="info" className="text-indigo-300 mb-2" />
                                        <p className="text-xs text-indigo-900/60 leading-relaxed">{t.hint}</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
